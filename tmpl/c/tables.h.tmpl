#pragma once

/* ==============================================================
   this is generated code, changes will be overwritten
   ============================================================== */

#include <stddef.h>
#include <time.h>

#include "table.h"

struct _DBColumnDef;
struct _UpsertStmt;
struct _DeleteStmt;
struct _SelectStmt;
struct _UniqKey;

{{ $td := . }}{{ range $db := .L.Databases }}{{ range $tbl := $db.Tables }}
/* ********************** table {{ $db.Name }}.{{ $tbl.Name }} ************************* */

typedef struct _{{ $db.Name }}_{{ $tbl.Name }} {
	struct _DBTable dbtbl;
} {{ $db.Name }}_{{ $tbl.Name }};

// {{ $db.Name }}.{{ $tbl.Name }}: initializes a datastructure
int create_{{ $db.Name }}_{{ $tbl.Name }}({{ $db.Name }}_{{ $tbl.Name }} *tbl,size_t rows);

const struct _DBTableDef* {{ $db.Name }}_{{ $tbl.Name }}_tbldef();

// {{ $db.Name }}.{{ $tbl.Name }}: getter/setter {{ range $col := $tbl.Columns }}
void {{ $db.Name }}_{{ $tbl.Name }}_unset_{{ $col.Name }}({{ $db.Name }}_{{ $tbl.Name }} *t,size_t row);
void {{ $db.Name }}_{{ $tbl.Name }}_setnull_{{ $col.Name }}({{ $db.Name }}_{{ $tbl.Name }} *t,size_t row);
{{ $td.PtrType $col }} {{ $db.Name }}_{{ $tbl.Name }}_set_{{ $col.Name }}({{ $db.Name }}_{{ $tbl.Name }} *t,size_t row);
const {{ $td.PtrType $col }} {{ $db.Name }}_{{ $tbl.Name }}_get_{{ $col.Name }}(const {{ $db.Name }}_{{ $tbl.Name }} *t,size_t row);
{{ end }}
{{ end }}{{/* tables */}}{{ end }}{{/* databases */}}